{% extends "base.html" %}
{% block title %}Applicants - {{ job.title }}{% endblock %}

{% block content %}
<!-- <div class="max-w-4xl mx-auto mt-10 bg-white p-6 rounded shadow">
    <h2 class="text-2xl font-bold mb-4">Applicants for: {{ job.title }}</h2>
    <p class="text-gray-600 mb-6">Job Location: {{ job.location }} | Salary: {{ job.salary }} CTC</p>

    {% if applications %}
        <table class="min-w-full divide-y divide-gray-200">
            <thead>
                <tr class="bg-gray-50">
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Candidate Name</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Phone</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Skills</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Experience (Years)</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Resume</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Applied On</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for app in applications %}
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">{{ app.candidate.candidateprofile.full_name }}</td>
                    <td class="px-6 py-4 whitespace-nowrap">{{ app.candidate.email }}</td>
                    <td class="px-6 py-4 whitespace-nowrap">{{ app.candidate.candidateprofile.phone_number }}</td>
                    <td class="px-6 py-4 whitespace-nowrap">{{ app.candidate.candidateprofile.skills }}</td>
                    <td class="px-6 py-4 whitespace-nowrap">{{ app.candidate.candidateprofile.experience }}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <a href="{{ app.candidate.candidateprofile.resume.url }}" class="text-indigo-600 hover:underline" target="_blank">View Resume</a>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">{{ app.applied_at|date:"M d, Y H:i" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-gray-500">No applicants yet for this job.</p>
    {% endif %}

    <div class="mt-4">
        <a href="{% url 'recruiter_dashboard' %}" class="text-indigo-600 hover:underline">Back to Dashboard</a>
    </div>
</div> -->

<div class="overflow-x-auto">
  <table class="min-w-full border border-gray-200 divide-y divide-gray-200">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Candidate Name</th>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Email</th>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Phone</th>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Skills</th>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Experience (Years)</th>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Resume</th>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Applied On</th>
        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Status</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      {% for app in applications %}
      <tr class="whitespace-normal">
        <td class="px-4 py-2">{{ app.candidate.candidateprofile.full_name }}</td>
        <td class="px-4 py-2">{{ app.candidate.email }}</td>
        <td class="px-4 py-2">{{ app.candidate.candidateprofile.phone_number }}</td>
        <td class="px-4 py-2 break-words">{{ app.candidate.candidateprofile.skills }}</td>
        <td class="px-4 py-2">{{ app.candidate.candidateprofile.experience }}</td>
        <td class="px-4 py-2">
          {% if app.candidate.candidateprofile.resume %}
            <a href="{{ app.candidate.candidateprofile.resume.url}}" target="_blank" class="text-indigo-600 hover:underline">View Resume</a>
          {% else %}
            -
          {% endif %}
        </td>
        <td class="px-4 py-2">{{ app.applied_at|date:"M d, Y H:i" }}</td>
         <td class="px-4 py-2">
          <form method="post" action="{% url 'update_application_status' app.id %}">
            {% csrf_token %}
            <select name="status" onchange="this.form.submit()" class="border rounded p-1">
              {% for value, label in app.STATUS_CHOICES %}
                <option value="{{ value }}" {% if app.status == value %}selected{% endif %}>
                  {{ label }}
                </option>
              {% endfor %}
            </select>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
